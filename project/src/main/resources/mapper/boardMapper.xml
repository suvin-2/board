<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="BoardDAO">

	<!-- 게시판 글 모두 조회 -->
	<select id="boardSelect" resultType="boardVO">
		SELECT B.BNO,
		       B.TITLE,
		       B.CONTENT,
		       B.CNT,
		       B.BDATE,
		       B.WRITER,
		       B.CNO,
		       C.CNAME,
		       C.SNAME
		FROM BOARD B, CATEGORY C
		WHERE B.CNO = C.CNO
		ORDER BY BNO DESC
	</select>
	
	<!-- 게시판 카테고리 별 게시글 조회 -->
	<select id="boardCategorySelect" resultType="boardVO">
		SELECT B.BNO,
		       B.TITLE,
		       B.CONTENT,
		       B.CNT,
		       B.BDATE,
		       B.WRITER,
		       B.CNO,
		       C.CNAME,
		       C.SNAME
		FROM BOARD B, CATEGORY C
		WHERE B.CNO = C.CNO AND C.CNAME = #{cName} AND C.SNAME = #{sName}
		ORDER BY BNO DESC
	</select>
	
	<!-- 게시글 단건 조회 -->
	<select id="boardSelectOne" resultType="boardVO">
		SELECT B.BNO,
		       B.TITLE,
		       B.CONTENT,
		       B.CNT,
		       B.BDATE,
		       B.WRITER,
		       B.CNO,
		       C.CNAME,
		       C.SNAME
		FROM BOARD B, CATEGORY C
		WHERE B.CNO = C.CNO AND B.BNO = #{bNo}
		ORDER BY BNO DESC
	</select>
	
	<!-- 게시글 작성 -->
	<insert id="boardInsert">
		<selectKey resultType="int" keyProperty="bNo" order="BEFORE">
			SELECT NVL(MAX(BNO),0)+1 FROM BOARD
		</selectKey>
		INSERT INTO BOARD (
			BNO,
			TITLE,
			CONTENT,
			CNT,
			BDATE,
			WRITER,
			CNAME,
			SNAME,
			CNO
		) VALUES (
			#{bNo},
			#{title},
			#{content},
			0,
			SYSDATE,
			#{writer},
			#{cName},
			#{sName},
			#{cNo}
		)
	</insert>
	
	<!-- 게시글 수정 -->
	<update id="boardUpdate">
		UPDATE
			BOARD
		SET
			TITLE = #{title},
			CONTENT = #{content},
			CNO = #{cNo}
		WHERE
			BNO = #{bNo}
	</update>

	<delete id="boardDelete">
		DELETE FROM 
				BOARD
		WHERE BNO = #{bNo}
	</delete>
</mapper>